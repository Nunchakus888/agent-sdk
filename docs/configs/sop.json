{
  "basic_settings": {
    "name": "YCloud Customer Service",
    "description": "Initiate conversations with customers and qualify their interest.  Briefly and clearly articulate the key benefit of the product or service in response to the customer's stated need. Persuade customers to provide their contact information during the conversation and thank customers when they provide it. Never hallucinate information.",
    "background": "YCloud is a leading WhatsApp business service provider, dedicated to helping businesses grow their businesses by leveraging WhatsApp, the world's most popular social app!",
    "instruction": "WORK PROCEDURE\n1. Start by warmly greeting the customer:\n\"Welcome {{$contact.nickname}}! Is there anything specific you're looking for today, or would you like some recommendations?\"\n1. Actively listen and analyze the customer's needs. If their request is vague, ask guiding questions such as:\n\"Are you looking for a specific type of product, or do you have a particular occasion in mind?\"\n1. Based on their response:\n  - Recommend suitable products by combining their needs with product knowledge (features, price, suitability).\n  - Provide clear comparisons if the customer is hesitating between options.\n  - If a product is out of stock or unavailable, promptly suggest similar alternatives.\n2. After providing recommendations:\n  - Ask: \"Would you like me to tell you more about any of these items, or check details like pricing and availability?\"\n3. If the customer is ready to proceed or has no further questions:\n  - Guide them to the next step: \"You can proceed to checkout directly, or I can help you with anything else.\"\n  - If the customer doesn't need any more help, politely close the conversation.\nCONTEXT\n- You are interacting with potential customers who may be browsing, comparing, or ready to purchase.\n- Their goals may include: finding a specific item, seeking gift ideas, comparing products, or asking about promotions.\n- Your objective is to facilitate a smooth shopping journey, increase customer satisfaction, and support conversion.\nROLE & COMMUNICATION STYLE\n- You are a professional, knowledgeable, and enthusiastic shopping assistant.\n- Your tone is friendly, encouraging, and slightly persuasive (focusing on benefits), but never pushy.\n- Use concise and vivid language to highlight product strengths. Keep responses focused, typically within 2-3 sentences.\nFOLLOW UP HANDLING\n- If there's no reply after 5 minutes, send: \"Hi, just checking if you're still there?\". And if still no reply after 5 minutes, send: \"I'll close the chat for now, but feel free to ask anytime!\" and close the conversation.\nFALL BACK HANDLING\n- If you don't understand the user's intent, first try to confirm it in a friendly manner. If you still cannot understand, escalate to human agents.\nBOUNDARIES\n- Do Not fabricate product specifications, prices, or stock information.\n- Do Not make overly absolute promises (e.g., \"This will definitely solve your problem\").\n- Do prioritize the customer's stated needs and budget.\n- Do consider and mention key factors such as occasion, recipient, seasonality, and popularity.",
    "language": "English",
    "tone": "Friendly and professional",
    "chatbot_id": "67adb3abaa26c063de0f4bd9"
  },
  "retrieve_knowledge_url": "http://121.43.165.245:18080/chatbot/ai-inner/retrieve-knowledge",
  "action_books": [
    {
      "condition": "1. Wants to schedule a demo 2. Requests detailed product/service information 3. Needs salesperson or account manager 4. Reveals purchase intention 5. Compares products between brands 6. Wants to sign up or get free trial 7. Asks for E-books or whitepapers 8. Inquires about pricing 9. Provide any contact information",
      "action": "Persuade the customer to provide required information, then save the customer's information using the save_customer_information tool",
      "tools": [
        "save_customer_information"
      ]
    },
    {
      "condition": "The customer clearly expresses the intention to transfer to a human agent ",
      "action": "Transfer to a human agent using the handoff_to tool and assign it to the team type and assignee is xyz.",
      "tools": [
        "handoff_to"
      ]
    }
  ],
  "system_actions": [
    "save_customer_information",
    "handoff_to",
    "close_conversation"
  ],
  "agent_actions": [
    "read_customer_information",
    "flow_executor",
    "actionbook_executor"
  ],
  "flows": [
    {
      "flow_id": "gretting",
      "description": "Greet the customer",
      "trigger_patterns": ["hello", "hi", "hey", "greetings"],
      "type": "keyword",
      "match_type":"exact"
    },
    {
      "flow_id": "product_recommendation",
      "description": "Recommend products to the customer",
      "trigger_patterns": ["recommend", "suggest", "product", "service"],
      "type": "intent",
      "match_type":"contains"
    }
  ],
  "tools": [
    {
      "name": "woocommerce_order_query_by_customer_id",
      "description": "Order query for WooCommerce orders by customer id",
      "parameters": {
        "type": "object",
        "properties": {
          "customer_id": {
            "type": "string",
            "description": "ID of the customer"
          }
        },
        "required": [
          "customer_id"
        ]
      },
      "endpoint": {
        "url": "https://wooycdev.lchnan.cn/wp-json/wc/v3/orders?customer={customer_id}&per_page=3",
        "method": "GET",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Basic Y2tfYWFmOTkzMjc1NDBjOWViMGI1NDdjMDhkZjcxOTUyMGQ1MGZhNTc5ZDpjc182YmQ0OWQ0YjBiMjQ2YTcwOGI5MDE0Y2E5Mzk0MjVhYWI4YjI5YTgw"
        },
        "body": "{}"
      }
    },
    {
      "name": "woocommerce_order_query_by_id",
      "description": "Order query for WooCommerce orders by order ID",
      "parameters": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "order id"
          }
        },
        "required": [
          "id"
        ]
      },
      "endpoint": {
        "url": "https://wooycdev.lchnan.cn/wp-json/wc/v3/orders/{id}",
        "method": "GET",
        "headers": {
          "Authorization": "Basic Y2tfYWFmOTkzMjc1NDBjOWViMGI1NDdjMDhkZjcxOTUyMGQ1MGZhNTc5ZDpjc182YmQ0OWQ0YjBiMjQ2YTcwOGI5MDE0Y2E5Mzk0MjVhYWI4YjI5YTgw",
          "Content-Type": "application/json"
        }
      }
    },
    {
      "name": "woocommerce_customer_query",
      "description": "Use customer's email address to query customer id",
      "parameters": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "The email address of the customer"
          }
        },
        "required": [
          "email"
        ]
      },
      "endpoint": {
        "url": "https://wooycdev.lchnan.cn/wp-json/wc/v3/customers?email={email}",
        "method": "GET",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Basic Y2tfYWFmOTkzMjc1NDBjOWViMGI1NDdjMDhkZjcxOTUyMGQ1MGZhNTc5ZDpjc182YmQ0OWQ0YjBiMjQ2YTcwOGI5MDE0Y2E5Mzk0MjVhYWI4YjI5YTgw"
        },
        "body": "{}"
      }
    },
    {
      "name": "YT_logistics_tracking",
      "description": "Tracking for YT Logistics packages",
      "parameters": {
        "type": "object",
        "properties": {
          "tracking_id": {
            "type": "string",
            "description": "YT tracking ID"
          }
        },
        "required": [
          "tracking_id"
        ]
      },
      "endpoint": {
        "url": "https://www.yto.net.cn/ec/order/gwWaybillInfoList",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "[\n  \"{tracking_id}\"\n]"
      }
    },
    {
      "name": "save_customer_information",
      "description": "Save customer information as fields are provided",
      "parameters": {
        "type": "object",
        "properties": {
          "email": {
            "description": "The email of the customer",
            "type": "string"
          }
        },
        "required": [
          "email"
        ]
      },
      "endpoint": {
        "url": "https://jsonplaceholder.typicode.com/posts",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "phoneNumber": "#phoneNumber#",
          "tenantId": "634cee9dca439909c72cdfd9",
          "email": "{email}"
        }
      }
    },
    {
      "name": "save_customer_information",
      "description": "Save customer information as fields are provided",
      "parameters": {
        "type": "object",
        "properties": {
          "web": {
            "description": "the official company website of the client",
            "type": "string"
          },
          "company_name": {
            "description": "The client's company name or abbreviation",
            "type": "string"
          },
          "phoneNumber": {
            "description": "The client's phone number",
            "type": "number"
          }
        },
        "required": [
          "company_name",
          "web",
          "phoneNumber"
        ]
      },
      "endpoint": {
        "url": "https://jsonplaceholder.typicode.com/posts",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "phoneNumber": "{phoneNumber}",
          "customAttrs": [
            {
              "value": "{company_name}",
              "key": "company_name"
            },
            {
              "value": "{web}",
              "key": "web"
            },
            {
              "value": "{phoneNumber}",
              "key": "phoneNumber"
            }
          ],
          "tenantId": "691420135f0a4e0c1983f7a0"
        }
      }
    },
    {
      "name": "get_weather_by_geo",
      "description": "get weather information by geo (lat and lon)",
      "parameters": {
        "type": "object",
        "properties": {
          "lat": {
            "type": "number",
            "description": "the lat number of a geo "
          },
          "lon": {
            "type": "number",
            "description": "the lon number of a geo"
          }
        },
        "required": [
          "lat",
          "lon"
        ]
      },
      "endpoint": {
        "url": "https://api.openweathermap.org/data/2.5/weather?lat={lat}&lon={lon}&appid=0142cc1a5c295ac07dac4c8c2c7ad4a3",
        "method": "GET",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{}"
      }
    },
    {
      "name": "city_geo_info",
      "description": "get the geography information of a city by city name.",
      "parameters": {
        "type": "object",
        "properties": {
          "city": {
            "type": "string",
            "description": "city name in english"
          }
        },
        "required": [
          "city"
        ]
      },
      "endpoint": {
        "url": "https://api.geoapify.com/v1/geocode/search?text={city}&apiKey=b143f80f38964538bdac7341ac627cd5",
        "method": "GET",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{}"
      }
    },
    {
      "name": "actionbook_executor",
      "description": "Execute the action book",
      "parameters": {
        "type": "object",
        "properties": {
          "actionBookId": {
            "type": "string",
            "description": "The ID of the action book"
          },
          "chatbotId": {
            "type": "string",
            "description": "The ID of the chatbot"
          },
          "tenantId": {
            "type": "string",
            "description": "The ID of the tenant"
          },
          "sessionId": {
            "type": "string",
            "description": "The ID of the session"
          },
          "message": {
            "type": "string",
            "description": "The message to execute the action book"
          }
        },
        "required": ["actionBookId", "chatbotId", "tenantId", "sessionId", "message"]
      },
      "endpoint": {
        "url": "http://172.16.92.21:18080/actionBookService/execute",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "actionBookId": "{actionBookId}",
          "chatbotId": "{chatbotId}",
          "tenantId": "{tenantId}",
          "sessionId": "{sessionId}",
          "message": "{message}"
        }
      }
    },
    {
      "name": "flow_executor",
      "description": "Execute the flow",
      "parameters": {
        "type": "object",
        "properties": {
          "flowId": {
            "type": "string",
            "description": "The ID of the flow"
          },
          "parameters": {
            "type": "object",
            "description": "The parameters of the flow"
          }
        },
        "required": ["flowId", "parameters"]
      },
      "endpoint": {
        "url": "{flow_url}",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "flowId": "{flowId}",
          "parameters": "{parameters}"
        }
      }
    },
    {
      "name": "read_customer_information",
      "description": "Read the customer's information from the database",
      "parameters": {
        "type": "object",
        "properties": {
          "customerId": {
            "type": "string",
            "description": "The ID of the customer"
          }
        }
      },
      "endpoint": {
        "url": "http://172.16.92.21:18080/contactsService/get",
        "method": "GET"
      }
    },
    {
      "name": "save_customer_information",
      "description": "Save the customer's information when they provide one or more fields",
      "trigger": "",
      "parameters": {
        "type": "object",
        "properties": {
          "nickName": {
            "type": "string",
            "description": "The name of the customer"
          },
          "email": {
            "type": "string",
            "description": "The email of the customer"
          },
          "dynamic_field_1": {
            "type": "string",
            "description": "The country of the customer",
            "default": null
          }
        },
        "required": ["email", "nickName"]
      },
      "endpoint": {
        "url": "http://172.16.92.21:18080/contactsService/add",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "nickName": "{nickName}",
          "phoneNumber": "todo_autofill_by_system",
          "email": "{email}",
          "customAttrs": [
            {
              "key": "dynamic_field_1",
              "value": {
                "dynamic_field_1": "{dynamic_field_1}"
              }
            }
          ]
        }
      }
    },
    {
      "name": "handoff_to",
      "description": "Transfer the current conversation to a human agent or team for further assistance. This tool allows you to hand off the conversation when the customer requests human support or when the conversation requires human intervention. You can specify the assignee type (owner, agent, unassigned, team, or lastAssignee) and optionally provide an assignee ID.",
      "trigger": "",
      "parameters": {
        "type": "object",
        "properties": {
          "assigneeId": {
            "type": "string",
            "description": "The ID of the assignee. Required when type is 'agent' or 'team', optional for other types (owner, unassigned, lastAssignee)",
            "default": null
          },
          "type": {
            "type": "string",
            "description": "The type of assignee to transfer the conversation to. Options include: owner (conversation owner), agent (specific agent), unassigned (no specific assignee), team (assign to a team), or lastAssignee (previous assignee)",
            "examples": ["owner", "agent", "unassigned", "team", "lastAssignee"],
            "default": "unassigned"
          }
        }
      },
      "endpoint": {
        "url": "http://172.16.80.52:8080/inboxConversationService/handoff",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body":{
          "assigneeId": "{assigneeId}",
          "type": "{type}",
          "dialogId": "todo_autofill_by_system"
        }
      }
    },
    {
      "name": "close_conversation",
      "description": "Close the current conversation by ending the dialog",
      "trigger": "",
      "parameters": {
        "type": "object",
        "properties": {}
      },
      "endpoint": {
        "url": "http://www-dev.ycloud.com/inbox-api/inboxConversationService/close",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "dialogId": 31234341
        }
      }
    }
  ]
}